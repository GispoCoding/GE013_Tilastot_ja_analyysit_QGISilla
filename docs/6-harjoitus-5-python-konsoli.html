<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<!-- Based on TemplateMo 553 Xtra Blog: https://templatemo.com/tm-553-xtra-blog -->

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="6 Harjoitus 5: Python-konsoli | Tilastot ja analyysit QGISillä" />
<meta property="og:type" content="book" />





<meta name="author" content="Gispo Oy." />

<meta name="date" content="2023-03-09" />


<meta name="description" content="6 Harjoitus 5: Python-konsoli | Tilastot ja analyysit QGISillä">

<title>6 Harjoitus 5: Python-konsoli | Tilastot ja analyysit QGISillä</title>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>



<link rel="stylesheet" href="custom.css" type="text/css" />

<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/hamburgers.css" rel="stylesheet">

</head>

<body>


<div class="main-content">
<!-- special comment to mark beginning of title section for bookdown -->
<!-- bookdown comments must be in this order: title, toc, body -->

<div class="main-content-wrapper">

<div class="row">
<div class="col-sm-12">
<header class="main-toc sidebar" id="sidebar">
<div class="sidebar-wrapper">

<button class="navbar-toggle hamburger hamburger--collapse" id="navbar-toggle"
type="button" onclick="navToggle()" aria-label="Toggle navigation">
<span class="hamburger-box"><span class="hamburger-inner"></span></span>
</button>

<div class="sidebar-title-wrapper">
<img alt="Logo" width="100" src="img/gispo_white_sm.png" class="sidebar-logo">
<div class="sidebar-title"><h1>Tilastot ja analyysit QGISillä</h1></div>
<div class="abstract-sidebar"><p>Jatkokurssi QGISin käytöstä.</p></div>
</div>

<nav class="sidebar-nav">
<div id="TOC" class="toc">
<ul>
<li><a href="index.html#tilastot-ja-analyysit-qgisillä"><span class="toc-section-number">1</span> Tilastot ja analyysit QGISillä</a>
<ul>
<li><a href="index.html#tervetuloa-qgis-jatkokurssille"><span class="toc-section-number">1.1</span> Tervetuloa QGIS-jatkokurssille!</a></li>
<li><a href="index.html#kurssimateriaalien-lataaminen"><span class="toc-section-number">1.2</span> Kurssimateriaalien lataaminen</a></li>
<li><a href="index.html#lukuohje"><span class="toc-section-number">1.3</span> Lukuohje</a></li>
<li><a href="index.html#mistä-lisätietoja"><span class="toc-section-number">1.4</span> Mistä lisätietoja?</a></li>
<li><a href="index.html#virheet"><span class="toc-section-number">1.5</span> Virheet</a></li>
<li><a href="index.html#lisenssi-ja-oikeudet"><span class="toc-section-number">1.6</span> Lisenssi ja oikeudet</a></li>
</ul></li>
<li><a href="2-harjoitus-1-qgis-käyttöliittymän-konfigurointi.html#harjoitus-1-qgis-käyttöliittymän-konfigurointi"><span class="toc-section-number">2</span> Harjoitus 1: QGIS-käyttöliittymän konfigurointi</a>
<ul>
<li><a href="2-harjoitus-1-qgis-käyttöliittymän-konfigurointi.html#valmistautuminen"><span class="toc-section-number">2.1</span> <strong>Valmistautuminen</strong></a></li>
<li><a href="2-harjoitus-1-qgis-käyttöliittymän-konfigurointi.html#käyttöliittymän-räätälöinti"><span class="toc-section-number">2.2</span> <strong>Käyttöliittymän räätälöinti</strong></a></li>
<li><a href="2-harjoitus-1-qgis-käyttöliittymän-konfigurointi.html#muokkauksen-yleisasetukset"><span class="toc-section-number">2.3</span> <strong>Muokkauksen yleisasetukset</strong></a></li>
<li><a href="2-harjoitus-1-qgis-käyttöliittymän-konfigurointi.html#käyttäjäprofiilit"><span class="toc-section-number">2.4</span> <strong>Käyttäjäprofiilit</strong></a></li>
<li><a href="2-harjoitus-1-qgis-käyttöliittymän-konfigurointi.html#pikanäppäimet"><span class="toc-section-number">2.5</span> <strong>Pikanäppäimet</strong></a></li>
<li><a href="2-harjoitus-1-qgis-käyttöliittymän-konfigurointi.html#taustakarttoja-lisäosien-avulla"><span class="toc-section-number">2.6</span> <strong>Taustakarttoja lisäosien avulla</strong></a></li>
</ul></li>
<li><a href="3-harjoitus-2-taulukosta-kartalle.html#harjoitus-2-taulukosta-kartalle"><span class="toc-section-number">3</span> Harjoitus 2: Taulukosta kartalle</a>
<ul>
<li><a href="3-harjoitus-2-taulukosta-kartalle.html#valmistautuminen-1"><span class="toc-section-number">3.1</span> <strong>Valmistautuminen</strong></a></li>
<li><a href="3-harjoitus-2-taulukosta-kartalle.html#pisteet-tekstitiedostosta-kartalle"><span class="toc-section-number">3.2</span> <strong>Pisteet tekstitiedostosta kartalle</strong></a></li>
<li><a href="3-harjoitus-2-taulukosta-kartalle.html#ilman-geometriaa-olevan-taulukon-tuominen"><span class="toc-section-number">3.3</span> <strong>Ilman geometriaa olevan taulukon tuominen</strong></a></li>
<li><a href="3-harjoitus-2-taulukosta-kartalle.html#taulukon-kenttien-tyypin-muokkaaminen"><span class="toc-section-number">3.4</span> <strong>Taulukon kenttien tyypin muokkaaminen</strong></a></li>
<li><a href="3-harjoitus-2-taulukosta-kartalle.html#taulukkotiedon-liittäminen-geometriaan"><span class="toc-section-number">3.5</span> <strong>Taulukkotiedon liittäminen geometriaan</strong></a></li>
</ul></li>
<li><a href="4-harjoitus-3-vektorianalyysi.html#harjoitus-3-vektorianalyysi"><span class="toc-section-number">4</span> Harjoitus 3: Vektorianalyysi</a>
<ul>
<li><a href="4-harjoitus-3-vektorianalyysi.html#valmistautuminen-2"><span class="toc-section-number">4.1</span> <strong>Valmistautuminen</strong></a></li>
<li><a href="4-harjoitus-3-vektorianalyysi.html#vektorianalyysi"><span class="toc-section-number">4.2</span> <strong>Vektorianalyysi</strong></a></li>
<li><a href="4-harjoitus-3-vektorianalyysi.html#tilastot"><span class="toc-section-number">4.3</span> <strong>Tilastot</strong></a></li>
<li><a href="4-harjoitus-3-vektorianalyysi.html#valinta-toisen-tason-sijainnin-perusteella"><span class="toc-section-number">4.4</span> <strong>Valinta toisen tason sijainnin perusteella</strong></a></li>
<li><a href="4-harjoitus-3-vektorianalyysi.html#dataplotly-lisäosa"><span class="toc-section-number">4.5</span> <strong>DataPlotly-lisäosa</strong></a></li>
<li><a href="4-harjoitus-3-vektorianalyysi.html#kohteiden-etäisyys-toisen-tason-pisteistä"><span class="toc-section-number">4.6</span> <strong>Kohteiden etäisyys toisen tason pisteistä</strong></a></li>
<li><a href="4-harjoitus-3-vektorianalyysi.html#pisteiden-lukumäärä"><span class="toc-section-number">4.7</span> <strong>Pisteiden lukumäärä</strong></a></li>
<li><a href="4-harjoitus-3-vektorianalyysi.html#aggregointi-ja-sulautus"><span class="toc-section-number">4.8</span> <strong>Aggregointi ja sulautus</strong></a></li>
<li><a href="4-harjoitus-3-vektorianalyysi.html#uusien-kenttien-laskeminen"><span class="toc-section-number">4.9</span> <strong>Uusien kenttien laskeminen</strong></a></li>
<li><a href="4-harjoitus-3-vektorianalyysi.html#päivittyvät-arvot"><span class="toc-section-number">4.10</span> <strong>Päivittyvät arvot</strong></a></li>
<li><a href="4-harjoitus-3-vektorianalyysi.html#etsi-omia-analyysityökaluja"><span class="toc-section-number">4.11</span> <strong>Etsi omia analyysityökaluja</strong></a></li>
</ul></li>
<li><a href="5-harjoitus-4-graafinen-mallintaja.html#harjoitus-4-graafinen-mallintaja"><span class="toc-section-number">5</span> Harjoitus 4: Graafinen mallintaja</a>
<ul>
<li><a href="5-harjoitus-4-graafinen-mallintaja.html#valmistautuminen-3"><span class="toc-section-number">5.1</span> <strong>Valmistautuminen</strong></a></li>
<li><a href="5-harjoitus-4-graafinen-mallintaja.html#graafisen-mallintajan-toiminnot"><span class="toc-section-number">5.2</span> <strong>Graafisen mallintajan toiminnot</strong></a></li>
<li><a href="5-harjoitus-4-graafinen-mallintaja.html#prosessin-laatiminen-ja-testaus"><span class="toc-section-number">5.3</span> <strong>Prosessin laatiminen ja testaus</strong></a></li>
<li><a href="5-harjoitus-4-graafinen-mallintaja.html#tallennetun-prosessin-käyttöönotto"><span class="toc-section-number">5.4</span> <strong>Tallennetun prosessin käyttöönotto</strong></a></li>
</ul></li>
<li><a href="6-harjoitus-5-python-konsoli.html#harjoitus-5-python-konsoli"><span class="toc-section-number">6</span> Harjoitus 5: Python-konsoli</a>
<ul>
<li><a href="6-harjoitus-5-python-konsoli.html#valmistautuminen-4"><span class="toc-section-number">6.1</span> <strong>Valmistautuminen</strong></a></li>
<li><a href="6-harjoitus-5-python-konsoli.html#python-konsolin-perusteet"><span class="toc-section-number">6.2</span> <strong>Python-konsolin perusteet</strong></a></li>
<li><a href="6-harjoitus-5-python-konsoli.html#python-skriptien-ajaminen-globe-builder--lisäosan-komentojen-hyödyntäminen"><span class="toc-section-number">6.3</span> <strong>Python-skriptien ajaminen: Globe Builder -lisäosan komentojen hyödyntäminen</strong></a></li>
<li><a href="6-harjoitus-5-python-konsoli.html#tee-bufferi-hyödyntäen-python-skriptiä"><span class="toc-section-number">6.4</span> <strong>Tee bufferi hyödyntäen Python-skriptiä</strong></a></li>
</ul></li>
</ul>
</div>
</nav>
</div>
</header>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="harjoitus-5-python-konsoli" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Harjoitus 5: Python-konsoli</h1>
<p><strong>Harjoituksen sisältö</strong></p>
<p>Harjoituksessa tutustutaan QGISin toiminnallisuuksien laajentamiseen Python-konsolin avulla.</p>
<p><strong>Harjoituksen tavoite</strong></p>
<p>Koulutettava oppii hyödyntämään Python-konsolia ja etsiä verkosta ohjelmointikoodeja siihen.</p>
<p><strong>Arvioitu kesto</strong></p>
<p>30 minuuttia.</p>
<div id="valmistautuminen-4" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> <strong>Valmistautuminen</strong></h2>
<p>Avaa uusi QGIS-projekti (<strong>Projekti &gt; Uusi</strong>) ja tallenna se nimellä <strong>"QGIS-harjoitus 5"</strong>. Lisää projektiin seuraavat aineistot:</p>
<ul>
<li><strong>..kurssihakemisto/HSY/HSY_vaestotietoruudukko_2019.gpkg</strong></li>
</ul>
</div>
<div id="python-konsolin-perusteet" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> <strong>Python-konsolin perusteet</strong></h2>
<p>QGISin Python-konsolin avulla voit automatisoida useita paikkatietoprosesseja QGISissä. Käytännössä pystyt nopeuttamaan useiden paikkatietoprosessien toimittamista opiskelemalla Python-ohjelmointikieltä sekä QGIS-kohtaisten PyQGIS-komentojen käyttöä.</p>
<p>Python on ohjelmointikieli, joka on paikkatieto-ohjelmistojen lisäksi kasvavasti käytössä eri toimialoilla. Pythonia kutsutaankin niin sanotusti lingua francaksi, sillä sen käyttötapaukset ulottuvat niin laajalle ja sen käyttöönotto ohjelmointikielenä on verrattain nopeaa. QGISissä Pythonia voi hyödyntää eri tavoilla. Niistä tärkeimmät alla:</p>
<ul>
<li><p>Python-kielen avulla voidaan <strong>automatisoida</strong> monia paikkatiedon prosessointiin ja analysointiin liittyviä <strong>toimintoja</strong>. Tämä nopeuttaa, helpottaa ja parantaa paikkatiedon käsittelyä.</p></li>
<li><p>Python-kielen avulla voidaan lisätä <strong>toistettavuutta</strong> paikkatietoprosesseissa. Näin Python-komentoja seuraamalla kuka vain voi toistaa paikkatietoprosessin jälkikäteen.  </p></li>
<li><p>Python-kielen avulla voidaan tuottaa <strong>QGIS-lisäosia</strong> (eng. plugins) organisaation tai laajempien työprosessien ratkaisemiksi.</p></li>
<li><p>Python-kielen avulla voidaan tuottaa <strong>prosessointialgoritmeja</strong> (eng. processing algorithms). Näillä algoritmeilla viitataan Python-skripteihin, jotka tallennetaan QGISiin ja niistä tulee omia pientyökaluja esim. paikkatietojen prosessoinnin tehtävien toteuttamiseen.</p></li>
</ul>
<p>QGISissa Pythonin käyttö pohjautuu ennen kaikkea QGISin Python-konsoliin, jolla voidaan ajaa Python-komentoja. Avaa konsoli klikkaamalla <img src="img/harjoitus_5/image1.png" /> tai valikosta menemällä <strong>Lisäosat &gt; Python-konsoli</strong>.</p>
<p><img src="img/harjoitus_5/image2.png" /></p>
<p>Konsoli aukenee karttaikkunan alapuolelle.</p>
<p><img src="img/harjoitus_5/image3.png" /></p>
<p><strong>Python-konsolissa</strong> voit ajaa normaalia Python-koodia. Syötä ja aja ensimmäiseksi seuraava koodi:</p>
<div class="code-box">
<p>print('Gispo loves FOSS4G')</p>
</div>
<p><img src="img/harjoitus_5/image4.png" /></p>
</div>
<div id="python-skriptien-ajaminen-globe-builder--lisäosan-komentojen-hyödyntäminen" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> <strong>Python-skriptien ajaminen: Globe Builder -lisäosan komentojen hyödyntäminen</strong></h2>
<p>Käyttötapauksissa, joissa nähdään hyödylliseksi Python-ohjelmointikielen hyödyntäminen QGISissä, voidaan etsiä verkosta hakukoneen avulla (esim. Google) valmiita Python-skriptejä QGISiin.</p>
<p>Ajetaan nyt yksi Python-skripti, niin näet miten Python-skriptejä voi ajaa QGISissä. Tässä haluamme nopeuttaa työprosessia, joten hyödynnämme Python-skriptiä tuottamaan karttavisualisoinnin QGISissä. Olet ehkä jo nähnyt Gispon toteuttaman <a href="https://github.com/GispoCoding/GlobeBuilder">Globe Builder -lisäosan</a>, jota kokeilemme nyt Python-konsolin kautta.</p>
<p><img src="img/harjoitus_5/image5.png" /></p>
<p>Lisäosaa käytetään pääasiallisesti lisäosan käyttöliittymän avulla. Käyttöliittymässä määritetään valintoja visualisaation tuottamiseksi. Haluamme nyt tuottaa maapallon muotoisen karttavisualisoinnin hyödyntäen Python-skriptiä käyttämättä lisäosan käyttöliittymää. Näin voimme mahdollisesti nopeuttaa toimiamme. Tämä olisi myös hyödyllistä mikäli tekisimme usean iteraation karttavisualisaation toteuttamiseksi tai jos hyödyntäisimme lisäosan toiminnallisuuksia osana jotakin muuta tietojärjestelmää, joka komentopohjaisesti voisi komentaa QGISiä toteuttamaan karttavisualisoinnin. Näin voisimme automatisoida työprosessejamme, minkä lisäksi kuka tahansa voi toistaa komentopohjaisen työprosessimme.</p>
<p>Voimme nähdä haluamme koodin <a href="https://gist.github.com/Joonalai/7b8693ef904df75cb15cb9af0e82c032">GitHubista</a>, mutta se löytyy myös kurssihakemistosta <strong>Muuta-kansion</strong> alta nimellä <strong>globeBuilder.py</strong>. Kyseessä on tekstitiedosto, johon on tallennettu Python-ohjelmointikielellä muutama toiminallisuus GlobeBuilderiin liittyen.</p>
<p>Avaa nyt kyseinen tiedosto QGISissä Python-konsoliin, konsolin koodi-editorin puolelle eli oikealle:</p>
<p><img src="img/harjoitus_5/image6.png" /></p>
<p>Kyseessä on lista erilaisia Python-komentoja, jotka tallennamme QGISiin ajamalla tekstitiedoston sisällön <img src="img/harjoitus_5/image7.png" />-painikkeesta. Klikkaa painiketta, joka ajaa koko komentosarjan kertaheitolla:</p>
<p><img src="img/harjoitus_5/image8.png" /></p>
<p>Aja nyt tiedoston omien ohjeiden (keltaisella) mukaisesti <strong>load_natural_earth_data()-komento</strong> konsolin puolella:</p>
<p><img src="img/harjoitus_5/image9.png" /></p>
<p>Huomaa: hyödynnettäesi load_natural_earth_data()-komentoa QGIS lataa ikään kuin automaattisesti verkosta datan ja visualisoi sen suoraan QGISissäsi. Näin näemmekin karttanäkymässämme metodin lataaman <strong>Natural Earth -aineiston</strong>:</p>
<p><img src="img/harjoitus_5/image10.png" /></p>
<p>Kokeile myös lisäosan muita toiminnallisuuksia suoraan Python-konsolista. Tutkittuasi kyseistä tekstitiedostoa löydät useamman eri toiminnallisuuden, joita tutkimalla opit hiukan Pythonin hyödyntämisestä QGISissä. Kokeile esim.  vaihtaa karttanäkymän taustaväriä mustaksi:</p>
<div class="code-box">
<p>change_background_color(color=QtCore.Qt.black)</p>
</div>
<p>Lue lisää komentojen hyödyntämisestä ja esimerkeistä <a href="https://github.com/GispoCoding/GlobeBuilder">lisäosan GitHub-repositoriosta</a>.</p>
</div>
<div id="tee-bufferi-hyödyntäen-python-skriptiä" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> <strong>Tee bufferi hyödyntäen Python-skriptiä</strong></h2>
<p>Kuvittele nyt toinen paikkatiedon käyttötapaus, jossa haluat tehdä väestötietoruudukolle sisäisen bufferin seuraavan näytönkaappauksen mukaisesti:</p>
<p><img src="img/harjoitus_5/image11.png" /></p>
<p>Skriptin avulla voidaan tuottaa sisäinen buffer-taso väestötietoruudukolle tai jollekin muulle polygon-aineistolle käyttämättä erinäisiä käyttöliittymään pohjautuvia työkaluja bufferin toteuttamiseen. Lisäksi voi nähdä mahdollisuutena kuvitella monivaiheisen paikkatietoprosessin, jonka yhdessä vaiheessa on toteutettava sisäinen buffer aineistolle. Myös tämänkaltaisissa työprosesseissa kyseisestä skriptistä olisi huomattavasti hyötyä.</p>
<p>Avaa <strong>buffer.py-tiedosto Muuta-kansion</strong> alta: </p>
<p><img src="img/harjoitus_5/image12.png" /></p>
<p>Tarkastele koodia ja huomioi, että tiedostopolut viittaavat kurssikansioosi. Koodissa on kommentteina eri komentojen toiminnot, lue ne ja kysy kouluttajalta tarvittaessa lisätietoa.</p>
<p>Ennen skriptin ajamista varmista, että sinulla on <strong>vaestotietoruudukko_2019-taso</strong> valittuna tasoluettelossa ja koodin alussa oikea tuloshakemisto valittuna. Sinun pitää muokata tuloshakemisto oman kansiorakenteesi mukaiseksi. </p>
<p><img src="img/harjoitus_5/image13.png" /></p>
<p>Aja koodi nyt painamalla editorin yllä olevaa <strong>Suorita-painiketta</strong>. Varmista, että viimeinen komento suoritetaan painamalla rivinvaihtoa. Lopputulos on koodin määrittelemällä paksuudella laskettu puskuritaso.</p>
<p>Kun olet valmis, tallenna projektitiedosto kurssihakemistoon pikanäppäimellä <strong>CTRL + T</strong> tai päävalikosta <strong>Projekti &gt; Tallenna</strong>.</p>
<div class="hint-box">
<p>Psst! Koulutuksen jälkeen saat henkilökohtaista tukea Gispon tukipalvelusta. Lähetä kysymyksesi tai kommenttisi osoitteeseen tuki@gispo.fi!</p>
</div>

</div>
</div>
<p style="text-align: center;">
<a href="5-harjoitus-4-graafinen-mallintaja.html"><button class="btn btn-default">Previous</button></a>
</p>
</div>
</div>

<footer class="footer text-center">

<div class="footer-container text-center">

<div class="footer-info">
<h5 class="footer-title">Tilastot ja analyysit QGISillä</h5>
<span class="footer-version">v2023-03-09</span>
<div class="license"><img src="img/by-nd.svg" width="80px" alt="CC-BY-ND"></div>
</div>

<div class="footer-info">
<h5 class="footer-title footer-company">Gispo Ltd.
<span class="footer-copyright-year">© 2023</span></h5>
<span class="footer-contact-info">Kalevankatu 31
<br>00100 Helsinki, Finland
<br>info@gispo.fi
</span>
</div>

</div>
</div>
</footer>
</div>


<script src="js/nav-script.js"></script>

</body>
</html>
